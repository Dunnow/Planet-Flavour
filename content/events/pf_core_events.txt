namespace = pf_core

event = {
	id = pf_core.0
	hide_window = yes
	is_triggered_only = yes
	fire_only_once = yes
	immediate = { set_global_flag = planet_flavour_is_active }
}

event = {
    id = pf_core.10
	hide_window = yes
	is_triggered_only = yes

	immediate = {
        every_system = {
            limit = {
                NOT = {
                    has_star_flag = home_system
                }
                count_system_planet = {
                    limit = {
                        pf_is_valid_planet_for_extraplanetary_life = yes
                    }
                    count > 1
                }
            }
            every_system_planet = {
                limit = {
                    pf_is_valid_planet_for_extraplanetary_life = yes
                }
                add_modifier = { modifier = pf_pm_extraplanetary_life }
            }
        }
    }
}

event = {
    id = pf_core.11
	hide_window = yes
	is_triggered_only = yes

	immediate = {
        every_system = {
            limit = {
                any_system_planet = {
                    has_ring = yes
                }
            }
            every_system_planet = {
                limit = { has_ring = yes }
                add_modifier = { modifier = pf_pm_planetary_rings }
            }
        }
    }
}

planet_event = {
    id = pf_core.20
    hide_window = yes
    is_triggered_only = yes

    immediate = {
        # Changed to a wet world
        if = {
            limit = { is_wet = yes }
            remove_modifier = pf_pm_ice_age
            remove_modifier = pf_pm_severe_droughts
            remove_modifier = pf_pm_toxic_spores
            remove_modifier = pf_pm_canyon_world
            
            remove_modifier = pf_pm_snowball_world
            remove_modifier = pf_pm_bone_world
            remove_modifier = pf_pm_abundant_parasites
        }
        # Changed to a dry world
        if = {
            limit = { is_dry = yes }
            remove_modifier = pf_pm_ice_age
            remove_modifier = pf_pm_biocrystals
            remove_modifier = pf_pm_floral_world
            remove_modifier = pf_pm_fungal_world

            remove_modifier = pf_pm_tidal_surges
            remove_modifier = pf_pm_toxic_spores
            remove_modifier = pf_pm_snowball_world
            remove_modifier = pf_pm_bone_world

            remove_modifier = pf_pm_megacoral_reefs
            remove_modifier = pf_pm_bioluminescent_flora
            remove_modifier = pf_pm_abundant_parasites
            remove_modifier = pf_pm_tropical_archipelagos

            remove_modifier = pf_pm_volcanic_soils
        }

        # Changed to a cold world
        if = {
            limit = { is_cold = yes }
            remove_modifier = pf_pm_biocrystals
            remove_modifier = pf_pm_floral_world

            remove_modifier = pf_pm_tidal_surges
            remove_modifier = pf_pm_toxic_spores
            remove_modifier = pf_pm_snowball_world
            remove_modifier = pf_pm_bone_world

            remove_modifier = pf_pm_megacoral_reefs
            remove_modifier = pf_pm_abundant_parasites
            remove_modifier = pf_pm_tropical_archipelagos
            remove_modifier = pf_pm_canyon_world

            remove_modifier = pf_pm_severe_droughts

            if = {
                limit = { NOT = { is_planet_class = pc_arctic}}
                remove_modifier = pf_pm_snowball_world
            }
        }
    }
}
# Terraforming to worlds with no / limited biosphere.
planet_event = {
    id = pf_core.21
    hide_window = yes
    is_triggered_only = yes

    # Remove ALL nature modifiers
    immediate = {
        if = {
            limit = {
                OR = {
                    is_planet_class = pc_city
                    is_planet_class = pc_machine
                    is_planet_class = pc_hive
                    is_planet_class = pc_nanotech
                    is_planet_class = pc_nuked
                    is_artificial = yes
                    AND = {
                        is_colony = no
                        is_colonizable = no
                    }
                }
            }
            if = {
                limit = {
                    # Going "up" a tier so we remove more negative mdoifiers
                    OR = {
                        is_planet_class = pc_city
                        is_planet_class = pc_machine
                        is_planet_class = pc_hive
                        is_planet_class = pc_nanotech
                        is_artificial = yes
                    }
                }
                remove_modifier = pf_pm_irradiated_world
                remove_modifier = pf_pm_severe_droughts
            }
            if = {
                limit = {
                    # Going "down" a tier, so we remove more positive modifiers
                    OR = {
                        is_planet_class = pc_nuked
                        AND = {
                            is_colony = no
                            is_colonizable = no
                        }
                    }
                }
                remove_modifier = pf_pm_extraplanetary_life
            }
            remove_modifier = pf_pm_ice_age
            remove_modifier = pf_pm_floral_world
            remove_modifier = pf_pm_biocrystals
            remove_modifier = pf_pm_overgrown

            remove_modifier = pf_pm_floating_rocks
            remove_modifier = pf_pm_tidal_surges
            remove_modifier = pf_pm_fungal_world
            remove_modifier = pf_pm_megacoral_reefs

            remove_modifier = pf_pm_bioluminescent_flora
            remove_modifier = pf_pm_toxic_spores
            remove_modifier = pf_pm_abundant_parasites
            remove_modifier = pf_pm_tropical_archipelagos

            remove_modifier = pf_pm_snowball_world
            remove_modifier = pf_pm_volcanic_soils
            remove_modifier = pf_pm_chirping_plains
            remove_modifier = pf_pm_bone_world
        }
    }
}